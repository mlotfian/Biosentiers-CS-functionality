<html>
  <head>
  <meta name="viewport" content="user-scalable=no, initial-scale=1, width=device-width">
  <meta charset="utf-8" />
  {% load staticfiles %}
  {% load static %}

    <link href="//cdn.bootcss.com/bootstrap-datetimepicker/4.17.44/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <script src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css" />
    <link rel="stylesheet" href="{% static 'index.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    <!--Autocomplete-->
    <link rel="stylesheet" href="https://cdn.rawgit.com/LeaVerou/awesomplete/gh-pages/awesomplete.css" />
    <script src="https://cdn.rawgit.com/LeaVerou/awesomplete/gh-pages/awesomplete.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  {{ form.media }}
  {{ species_form.media }}
  {{ observation_form.media }}
  {{ poi_form.media }}

  </head>
  <body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <span class="navbar-brand mb-0 h1">
          <img class="brandsize" src="{% static 'images/bio.png' %}" alt="">
        </span>
    </nav>

  <div>
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

    <div >{{ poi_form.geometry }}</div>

    <div id="observation_type">

        <select style="padding-left: 10px;" class="species_form" name="obs_type">
            <option value="" selected disabled hidden>Select species type</option>
            <!--{% for obs in species_form.obs_type %}
            <option value="{{obs.value}}">{{ obs.value }}</option>

            {% endfor %}-->
            <option value="tree">Tree</option>
            <option value="bird">Bird</option>
            <option value="butterfly">Butterfly</option>
            <option value="flower">Flower</option>

        </select>
    </div>
      <div style="padding: 10px;"><input id="species" class="species_form" name="name" placeholder="Enter species name"></div>
      <div style="padding: 10px;"><input class="observation_form" name="description" placeholder="Enter your description"></div>
      <div style="padding: 10px;"><p>Select Date:</p>{{ observation_form.date }}</div>
      <div style="padding: 10px;"><p>Select Photo:</p>{{ observation_form.photo }}</div>

      <div><input type="submit" value="Submit"></div>
    </form>
 </div>

 <!--  Autocomplete name, from BioSentiers db -->
<script type="text/javascript">
var speciesNameInput = document.getElementById("species");

var awesomplete = new Awesomplete(speciesNameInput, {
  minChars: 1,
  autoFirst: true
});


$("#observation_type").on("change", function() {
  var selectedObsType = $("#observation_type :selected").text().toLowerCase();
  $.ajax({
    url: 'https://biosentiers.heig-vd.ch/api/species?only=commonName.fr&theme=' + selectedObsType,
    type: 'GET',
    dataType: 'json'
  })
  .success(function(data) {
    var list = [];
    $.each(data, function(key, value) {
      list.push(value.commonName.fr);
    });
    awesomplete.list = list;
  });
});



</script>

<!-- invalid photo warning -->

<script type="text/javascript">

  $(document).ready(function() {
    $(function() {
      $( "#invalidPhoto" ).dialog({
        modal: true,
        closeOnEscape: false,
        dialogClass: "no-close",
        resizable: false,
        draggable: false,
        width: 600,
        buttons: [
          {
            text: "OK",
            click: function() {
              $( this ).dialog( "close" );
            }
          }
        ]
      });
    });
  }
);

// Invalid photo
{% if invalidPhoto %}
  <div id="invalidPhoto" title="Invalid Photo">
    <p>Please make sure you have selected the right species type</p>
  </div>
{% endif %}
</script>


  </body>
</html>
